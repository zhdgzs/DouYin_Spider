# Change: 添加 Web API 接口和前端页面

## Why

当前项目是纯命令行工具，使用门槛较高：
1. 需要修改 Python 代码才能执行不同任务
2. 没有可视化界面，不便于非技术用户使用
3. 无法通过 HTTP 接口集成到其他系统

添加 FastAPI 后端和前端页面可以：
- 降低使用门槛，提供友好的 Web 界面
- 支持 HTTP API 调用，便于系统集成
- 实时预览视频，提升用户体验

## What Changes

### Phase 1（本次实现）
- **ADDED** FastAPI 后端服务 (`api/`)
- **ADDED** 视频解析 API 接口 (`/api/video/parse`)
- **ADDED** 前端页面（Vue 3 + Vite）
- **ADDED** 视频链接输入和多清晰度输出功能
- **ADDED** 视频预览播放器

### Phase 2（后续规划）
- 用户作品批量爬取接口
- 搜索功能接口
- 直播监听 WebSocket 接口
- 数据导出功能

## Impact

- Affected specs: 新增 `web-api` capability
- Affected code:
  - 新增 `api/` 目录（FastAPI 后端）
  - 新增 `web/` 目录（前端页面）
  - 新增 `requirements-api.txt`（API 专用依赖，不影响原有 requirements.txt）
- **不影响现有代码**:
  - `main.py` 保持不变，原有命令行功能完全保留
  - `dy_apis/`、`builder/`、`utils/` 等模块仅被引用，不做修改
  - 新增的 API 服务独立运行，与原有爬虫功能互不干扰

## 现有功能梳理

| 功能模块 | 当前实现 | API 化优先级 |
|---------|---------|-------------|
| 视频信息获取 | `DouyinAPI.get_work_info()` | **P0 - 本次实现** |
| 用户作品列表 | `DouyinAPI.get_user_all_work_info()` | P1 |
| 搜索作品 | `DouyinAPI.search_general_work()` | P1 |
| 搜索用户 | `DouyinAPI.search_user()` | P2 |
| 搜索直播 | `DouyinAPI.search_live()` | P2 |
| 评论获取 | `DouyinAPI.get_work_all_comment()` | P2 |
| 直播监听 | `DouyinLive` WebSocket | P3 |
| 收藏管理 | `DouyinAPI.collect_aweme()` | P3 |
| 粉丝/关注列表 | `DouyinAPI.get_user_follower_list()` | P3 |

## 前端页面规划

### Phase 1 页面（本次实现）
```
┌─────────────────────────────────────────────────────────────┐
│  🎵 抖音视频解析工具                                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  输入抖音链接：                                              │
│  ┌─────────────────────────────────────────────┐ [解析]     │
│  │ https://www.douyin.com/video/xxx            │           │
│  └─────────────────────────────────────────────┘           │
│                                                             │
│  视频信息：                                                  │
│  ├── 标题: xxx                                              │
│  ├── 作者: xxx                                              │
│  ├── 点赞: xxx  评论: xxx  分享: xxx                        │
│  └── 发布时间: xxx                                          │
│                                                             │
│  清晰度选择（点击切换预览）：                                 │
│  ┌─────────────────────────────────────────────────────────┐
│  │ 清晰度   │ 分辨率    │ 文件大小  │ 操作                 │
│  ├──────────┼───────────┼───────────┼─────────────────────┤
│  │ ● 720p   │ 1280x720  │ 12.5 MB   │ [复制链接] [下载]   │
│  │ ○ 540p   │ 960x540   │ 8.2 MB    │ [复制链接] [下载]   │
│  │ ○ 360p   │ 640x360   │ 4.1 MB    │ [复制链接] [下载]   │
│  └─────────────────────────────────────────────────────────┘
│  （● 表示当前预览的清晰度，点击行切换）                       │
│                                                             │
│  视频预览：                                                  │
│  ┌─────────────────────────────────────────────────────────┐
│  │                                                         │
│  │                 📺 视频预览播放器                        │
│  │              （显示当前选中清晰度的视频）                 │
│  │                                                         │
│  └─────────────────────────────────────────────────────────┘
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 交互说明
1. **清晰度联动预览**：点击清晰度列表中的任意一行，播放器自动切换到对应清晰度的视频
2. **文件大小显示**：每个清晰度显示对应的文件大小（从 API 获取或通过 Content-Length 计算）
3. **默认选中最高清晰度**：解析完成后默认选中并预览最高清晰度版本

### Phase 2 页面（后续规划）
- 用户作品列表页
- 搜索结果页
- 批量下载管理页
- 直播监控页
